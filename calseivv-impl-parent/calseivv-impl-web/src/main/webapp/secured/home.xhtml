<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <title>Home</title>
    <link rel="stylesheet" href="../resources/css/style.css" type="text/css"/>
    <link rel="icon" href="../resources/images/icon.png" type="image/icon type"/>
</h:head>

<h:body>
    <f:event type="preRenderView" listener="#{homeController.display}"/>
    <h:form id="homeForm">
        <p:toolbar>
            <p:toolbarGroup>
                <p:graphicImage name="images/logo.svg" height="70px" width="150px"/>
            </p:toolbarGroup>
            <p:toolbarGroup>
                <p:commandButton action="#{loginController.userLogout}" value="Logout"
                                 style="margin-left: 20px;"></p:commandButton>
            </p:toolbarGroup>
        </p:toolbar>
        <br/>
        <p:panel header="User Profile">
            <h:panelGrid id="loginPanel" columns="2" columnClasses="col1, col2">
                <p:card style="height: 100%">
                    <f:facet name="title">
                        #{homeController.userResponse.userInfo.firstName}
                        #{homeController.userResponse.userInfo.lastName}
                    </f:facet>
                    <f:facet name="subtitle">
                        #{homeController.displayRole}
                    </f:facet>

                    <div align="center">
                        <p:graphicImage
                                value="#{homeController.contentResponse.contentImagesMap['portrait']}"
                                rendered="#{not empty homeController.contentResponse.contentImagesMap['portrait']}"
                                height="150px" width="200px" cache="false"/>
                        <p:graphicImage name="images/user_icon.svg" height="150px" width="200px" cache="false"
                                        rendered="#{empty homeController.contentResponse.contentImagesMap['portrait']}"/>
                        <p:button value="Verified" styleClass="ui-button-success ui-button-flat"
                                  rendered="#{homeController.userResponse.userInfo.verified}"
                                  disabled="true" alt="verified"/>
                        <p:button value="Not Verified" styleClass="ui-button-warning ui-button-flat"
                                  rendered="#{not homeController.userResponse.userInfo.verified}"
                                  disabled="true"/>
                    </div>
                </p:card>
                <p:card rendered="#{homeController.displayExam}">
                    <p:card>
                        <f:facet name="title">
                            Exam Status
                        </f:facet>
                        <h:outputText value=" You have completed the exam"
                                      rendered="#{homeController.displayScore and homeController.userVerified}"/>
                        <h:outputText value=" You have not taken the exam"
                                      rendered="#{not homeController.displayScore and homeController.userVerified}"/>
                        <h:outputText value=" You cannot take the exam unless verified"
                                      rendered="#{not homeController.userVerified}"/>
                        <br/><br/>
                        <p:button value="Take Exam" outcome="/secured/exam.jsf?faces-redirect=true"
                                  rendered="#{homeController.userVerified and not homeController.displayScore}"/>
                    </p:card>
                    <p:card rendered="#{homeController.displayScore}">
                        <f:facet name="title">
                            Exam Score
                        </f:facet>
                        <h:panelGrid columns="4" style="width:100%">
                            <p:card>
                                <f:facet name="subtitle">
                                    Science
                                </f:facet>
                                <div align="center">
                                    <p:knob id="sc" value="#{homeController.scoreResponse.score.science}" max="20"
                                            disabled="true" height="100px;"
                                            foregroundColor="green"/>
                                </div>
                            </p:card>
                            <p:card>
                                <f:facet name="subtitle">
                                    Mathematics
                                </f:facet>
                                <div align="center">
                                    <p:knob id="mt" value="#{homeController.scoreResponse.score.mathematics}" max="10"
                                            disabled="true" height="100px;"
                                            foregroundColor="blue"/>
                                </div>
                            </p:card>
                            <p:card>
                                <f:facet name="subtitle">
                                    Language Proficiency
                                </f:facet>
                                <div align="center">
                                    <p:knob id="lp" value="#{homeController.scoreResponse.score.languageProficiency}"
                                            max="17" disabled="true" height="100px;"
                                            foregroundColor="orange"/>
                                </div>
                            </p:card>
                            <p:card>
                                <f:facet name="subtitle">
                                    Reading Comprehension
                                </f:facet>
                                <div align="center">
                                    <p:knob id="rc" value="#{homeController.scoreResponse.score.readingComprehension}"
                                            max="3" disabled="true" height="100px;"
                                            foregroundColor="purple"/>
                                </div>
                            </p:card>
                        </h:panelGrid>
                        <p:card>
                            <f:facet name="subtitle">
                                <b>OVERALL</b>
                            </f:facet>
                            <div align="center">
                                <p:knob id="ov" value="#{homeController.scoreResponse.score.overallScore}" max="50"
                                        disabled="true" height="100px;"/>
                            </div>
                        </p:card>
                    </p:card>
                </p:card>
                <p:card rendered="#{homeController.displayUsers}">
                    <p:dataTable id="studentList" var="stud" value="#{homeController.userResponseList.userList}"
                                 rows="5"
                                 paginator="true"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="{startRecord}-{endRecord} of {totalRecords} records"
                                 rowsPerPageTemplate="5,10,{ShowAll|'All'}" sortMode="single">
                        <f:facet name="header">
                            Examinee List
                        </f:facet>
                        <p:column sortBy="#{stud.lastName}" headerText="Last Name" sortOrder="asc">
                            <h:outputText value="#{stud.lastName}"/>
                        </p:column>

                        <p:column sortBy="#{stud.firstName}" headerText="First Name">
                            <h:outputText value="#{stud.firstName}"/>
                        </p:column>

                        <p:column headerText="Application ID">
                            <h:outputText value="#{stud.applicationId}"/>
                        </p:column>

                        <p:column sortBy="#{stud.verified}" headerText="Verified">
                            <p:button value="Verified" styleClass="rounded-button ui-button-success"
                                      rendered="#{stud.verified}" disabled="true"/>
                            <p:button value="Not Verified" styleClass="rounded-button ui-button-warning"
                                      rendered="#{not stud.verified}" disabled="true"/>
                        </p:column>

                        <p:column headerText="Actions">
                            <p:dialog id="userInfoDialog" header="User Info" widgetVar="dlg1" showEffect="fade"
                                      modal="true" width="1300px" height="550px">
                                <p:panelGrid columns="2">
                                    <p:panelGrid columns="2">
                                        <f:facet name="header">
                                            <p:graphicImage
                                                    value="#{homeController.contentView.contentImagesMap['portrait']}"
                                                    rendered="#{not empty homeController.contentView.contentImagesMap['portrait']}"
                                                    height="200px" cache="false"/>
                                            <p:graphicImage name="images/user_icon.svg" height="150px" width="200px"
                                                            cache="false"
                                                            rendered="#{empty homeController.contentView.contentImagesMap['portrait']}"/>
                                        </f:facet>
                                        <h:outputText value="Name:"/>
                                        <h:outputText
                                                value="#{homeController.userView.userInfo.lastName}, #{homeController.userView.userInfo.firstName} #{homeController.userView.userInfo.middleName}"/>

                                        <h:outputText value="Birthdate:"/>
                                        <h:outputText value="#{homeController.userView.userInfo.birthdate}">
                                            <f:convertDateTime pattern="yyyy-dd-MM"/>
                                        </h:outputText>

                                        <h:outputText value="Application ID:"/>
                                        <h:outputText value="#{homeController.userView.userInfo.applicationId}"/>

                                        <h:outputText value="Taken the Examination?"/>
                                        <p:button icon="pi pi-check" styleClass="rounded-button ui-button-flat"
                                                  rendered="#{homeController.userView.userInfo.takenExam}"
                                                  disabled="true"/>
                                        <p:button icon="pi pi-times"
                                                  styleClass="rounded-button ui-button-danger ui-button-flat"
                                                  rendered="#{not homeController.userView.userInfo.takenExam}"
                                                  disabled="true"/>

                                    </p:panelGrid>

                                    <p:panelGrid columns="1">
                                        <p:card>
                                            <f:facet name="subtitle">
                                                Identification
                                            </f:facet>
                                            <div style="text-align: center;">
                                                <p:graphicImage
                                                        value="#{homeController.contentView.contentImagesMap['identification']}"
                                                        height="200px"
                                                        rendered="#{not empty homeController.contentView}"
                                                        cache="false"/>
                                                <p:graphicImage name="images/user_icon.svg" height="150px" width="200px"
                                                                cache="false"
                                                                rendered="#{empty homeController.contentView.contentImagesMap['identification']}"/>

                                                <div style="margin-top: 10px;">
                                                    <p:commandButton action="#{homeController.verify(stud.id)}"
                                                                     value="Verify Examinee"
                                                                     icon="pi pi-check"
                                                                     update="studentList"
                                                                     rendered="#{not homeController.userView.userInfo.verified}"/>
                                                </div>
                                            </div>
                                        </p:card>

                                        <p:panelGrid columns="5"
                                                     rendered="#{homeController.userView.userInfo.takenExam}"
                                                     style="text-align:center"
                                                     columnClasses="firstColumn,secondColumn,thirdColumn,fourthColumn,fifthColumn">

                                            <h:outputText value="Science" style="font-weight:bold"/>
                                            <h:outputText value="Math" style="font-weight:bold"/>
                                            <h:outputText value="Language Proficiency" style="font-weight:bold"/>
                                            <h:outputText value="Reading Comprehension" style="font-weight:bold"/>
                                            <h:outputText value="Overall Score" style="font-weight:bold"/>

                                            <h:outputText
                                                    value="#{homeController.scoreViewResponse.score.science}"/>
                                            <h:outputText
                                                    value="#{homeController.scoreViewResponse.score.mathematics}"/>
                                            <h:outputText
                                                    value="#{homeController.scoreViewResponse.score.languageProficiency}"/>
                                            <h:outputText
                                                    value="#{homeController.scoreViewResponse.score.readingComprehension}"/>
                                            <h:outputText
                                                    value="#{homeController.scoreViewResponse.score.overallScore}"/>

                                        </p:panelGrid>
                                    </p:panelGrid>

                                </p:panelGrid>


                            </p:dialog>
                            <p:commandButton value="View" oncomplete="PF('dlg1').show()"
                                             action="#{homeController.viewUserInfo(stud.id)}"
                                             update="userInfoDialog"
                                             icon="pi pi-eye"/>
                        </p:column>

                    </p:dataTable>
                </p:card>
            </h:panelGrid>
        </p:panel>

    </h:form>

    <div class="footer">
        <p>© 2021 Calamba City Science High School</p>
    </div>

</h:body>
</html>